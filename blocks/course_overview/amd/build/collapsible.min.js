define(["jquery","core/log","core/yui"],function(a,b,c){function d(b,c,d){var e=this;e.userpref=c,e.div=a("#"+b),e.divHeight=e.div.height(),e.caption=a("#"+b+"_caption"),e.caption.attr("title",d),e.animations={};var f=a('<a href="#"></a>');e.caption.children().wrap(f),e.div.hasClass("collapsed")&&e.div.height(e.caption.outerHeight()+"px"),e.caption.click(function(b){b.preventDefault(),a.proxy(e.yuiToggleDiv,e)()})}return d.prototype.yuiToggleDiv=function(){var a=this;c.use("anim",function(b){var c,d=b.one("#"+a.div.attr("id"));a.animations[a.div.attr("id")]?c=a.animations[a.div.attr("id")]:(c=new b.Anim({node:d,duration:.3,easing:b.Easing.easeBoth,to:{height:a.caption.outerHeight()+"px"},from:{height:a.divHeight}}),c.on("end",function(){d.toggleClass("collapsed")},a),a.animations[a.div.attr("id")]=c),c.get("running")&&c.stop(),c.set("reverse",d.hasClass("collapsed")),a.userpref&&M.util.set_user_preference(a.userpref,!d.hasClass("collapsed")),c.run()})},d.prototype.jqueryToggleDiv=function(){var a,b=this;a=b.div.hasClass("collapsed")?{height:b.divHeight}:{height:b.caption.outerHeight()},b.div.animate(a,300,"swing",function(){b.div.toggleClass("collapsed"),b.userpref&&M.util.set_user_preference(b.userpref,!b.div.hasClass("collapsed"))})},{userpref:null,div:null,collapsible:function(a,b,c){b&&(this.userpref=!0),new d(a,b,c)}}});